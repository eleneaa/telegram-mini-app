{% include 'index.html' with active='tests' %}
{% load static %}

{% block content %}

    <div class="image-container p-0 m-0">
        <img class='p-0 m-0' src="{% static catalog.image %}"
             style="width: 100%; height: 100%; max-height: 35vh; min-height: 35vh">
    </div>
    <div class="container p-4 pt-0 content-box rounded-top-5 shadow-lg" style="padding-top: 0 !important;">
        <div class="container p-0 m-0">
            <div class="container p-3 text-center">
                <h1 style="margin: 0; padding: 0"><b>{{ catalog.name }}</b>
                </h1>
            </div>
        </div>
        <div class="row text-wrap text-break" style="line-height: 20px; padding-bottom: 20px">
            {% if catalog.description %}<span>{{ catalog.description }}</span>
            {% else %}<span>Описание отсутствует</span>
            {% endif %}
        </div>
        <div class="text-center pb-3">
            <a href="{% url 'categories:set_current_category' catalog.id %}">
                <button class="btn btn-primary col-12 shadow rounded-4">Сделать активной
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="icon icon-tabler icons-tabler-outline icon-tabler-corner-right-up">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <path d="M6 18h6a3 3 0 0 0 3 -3v-10l-4 4m8 0l-4 -4"/>
                    </svg>
                </button>

            </a>
        </div>
        <div class="pb-3">
            <div class="mb-3">
                <h1 class="mb-2">Список атласов категории</h1>
                {% include "scrollable_atlases_cards.html" with atlases=catalog.atlases_ids %}
                <a href="{% url "atlases:popular_atlases" %}">
                    <button class="btn btn-primary btn-sm mt-2 rounded-pill shadow"><span class='m-2'
                                                                                          style="margin-right: 1px !important">Посмотреть все</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                             fill="currentColor"
                             class="icon icon-tabler icons-tabler-filled icon-tabler-circle-arrow-up-right">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                            <path d="M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-2 4.66h-6l-.117 .007a1 1 0 0 0 -.883 .993l.007 .117a1 1 0 0 0 .993 .883h3.584l-4.291 4.293l-.083 .094a1 1 0 0 0 1.497 1.32l4.293 -4.293v3.586l.007 .117a1 1 0 0 0 1.993 -.117v-6l-.007 -.117l-.029 -.149l-.035 -.105l-.054 -.113l-.071 -.111a1.01 1.01 0 0 0 -.097 -.112l-.09 -.08l-.096 -.067l-.098 -.052l-.11 -.044l-.112 -.03l-.126 -.017l-.075 -.003z"/>
                        </svg>
                    </button>
                </a>
            </div>
        </div>
        <div class="pb-3">
            <div class="mb-3">
                <h1 class="mb-2">Список тестов категории</h1>
                {% include "scrollable_tests_cards.html" with tests=catalog.tests_ids %}
                <a href="{% url 'tests:list_popular_tests' %}">
                    <button class="btn btn-primary btn-sm mt-2 rounded-4 shadow-lg"><span class='m-2'
                                                                                          style="margin-right: 1px !important">Посмотреть все</span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                             fill="currentColor"
                             class="icon icon-tabler icons-tabler-filled icon-tabler-circle-arrow-up-right">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                            <path d="M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-2 4.66h-6l-.117 .007a1 1 0 0 0 -.883 .993l.007 .117a1 1 0 0 0 .993 .883h3.584l-4.291 4.293l-.083 .094a1 1 0 0 0 1.497 1.32l4.293 -4.293v3.586l.007 .117a1 1 0 0 0 1.993 -.117v-6l-.007 -.117l-.029 -.149l-.035 -.105l-.054 -.113l-.071 -.111a1.01 1.01 0 0 0 -.097 -.112l-.09 -.08l-.096 -.067l-.098 -.052l-.11 -.044l-.112 -.03l-.126 -.017l-.075 -.003z"/>
                        </svg>
                    </button>
                </a>
            </div>
        </div>
        <div class="mb-3">
            <h1 class="mb-2">Список статей категории</h1>
            {% include "scrollable_articles_cards.html" with articles=catalog.articles_ids %}
            <a href="{% url "articles:popular_articles" %}">
                <button class="btn btn-primary btn-sm mt-2 rounded-4 shadow-lg"><span class='m-2'
                                                                                      style="margin-right: 1px !important">Посмотреть все</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                         fill="currentColor"
                         class="icon icon-tabler icons-tabler-filled icon-tabler-circle-arrow-up-right">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <path d="M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-2 4.66h-6l-.117 .007a1 1 0 0 0 -.883 .993l.007 .117a1 1 0 0 0 .993 .883h3.584l-4.291 4.293l-.083 .094a1 1 0 0 0 1.497 1.32l4.293 -4.293v3.586l.007 .117a1 1 0 0 0 1.993 -.117v-6l-.007 -.117l-.029 -.149l-.035 -.105l-.054 -.113l-.071 -.111a1.01 1.01 0 0 0 -.097 -.112l-.09 -.08l-.096 -.067l-.098 -.052l-.11 -.044l-.112 -.03l-.126 -.017l-.075 -.003z"/>
                    </svg>
                </button>
            </a>
        </div>

        {% if catalog.child.all|length > 0 %}
            <h1>Дочерние каталоги</h1>
            <!-- Сетка для категорий -->
            <div class="row row-cols-1 row-cols-md-3 pt-3 g-3">
                {% for catalog in catalog.child.all %}
                    <div class="col">
                        <div class="card shadow-sm h-100">
                            <!-- Иконка или изображение категории -->
                            <div class="card-body">
                                <h5 class="card-title">{{ catalog.name }}</h5>
                                <p class="card-text text-muted">
                                    {{ catalog.description|truncatechars:100 }}
                                </p>
                                <a href="{{ catalog.get_absolute_url }}" class="btn btn-primary">Открыть</a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}

    </div>

{% endblock %}

{#{% block content %}#}
{#    <div class="container py-4">#}
{#        <!-- Название категории -->#}
{#        <h1 class="text-center mb-4">{{ catalog.name }}</h1>#}
{##}
{#        <!-- Изображение категории -->#}
{#        <div class="text-center mb-4">#}
{#            {% if catalog.image %}#}
{#                <img src="{% static catalog.image %}" alt="Фото категории" class="img-fluid rounded shadow-sm"#}
{#                     style="max-height: 300px;">#}
{#            {% else %}#}
{#                <img src="{% static 'images/default_category.jpg' %}" alt="Фото категории"#}
{#                     class="img-fluid rounded shadow-sm" style="max-height: 300px;">#}
{#            {% endif %}#}
{#        </div>#}
{##}
{#        <!-- Описание категории -->#}
{#        <div class="text-center mb-4">#}
{#            <p class="text-muted">{{ catalog.description }}</p>#}
{#        </div>#}
{##}
{#        <!-- Кнопка избранного -->#}
{#        <div class="text-center">#}
{#            <button id="favorite-button"#}
{#                    class="btn {% if is_favorite %}btn-danger{% else %}btn-outline-danger{% endif %}"#}
{#                    data-item-id="{{ catalog.id }}">#}
{#                {% if is_favorite %}#}
{#                    Удалить из избранного#}
{#                {% else %}#}
{#                    Добавить в избранное#}
{#                {% endif %}#}
{#            </button>#}
{#        </div>#}
{##}
{#        <a href="{% url 'categories:set_current_category' catalog.id %}">#}
{#            <button class="btn btn-primary">Сделать активной</button>#}
{#        </a>#}
{##}
{#    </div>#}
{##}
{#    <!-- jQuery -->#}
{#    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>#}
{##}
{#    <!-- CSRF-токен -->#}
{#    {% csrf_token %}#}
{#    <script>#}
{#        const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;#}
{##}
{#        $(document).ready(function () {#}
{#            $('#favorite-button').click(function () {#}
{#                var button = $(this);#}
{#                var categoryId = button.data('item-id');#}
{##}
{#                $.ajax({#}
{#                    url: `/categories/favorite/${categoryId}/`,#}
{#                    type: 'POST',#}
{#                    headers: {#}
{#                        'X-CSRFToken': csrftoken#}
{#                    },#}
{#                    success: function (response) {#}
{#                        if (response.action === 'added') {#}
{#                            button.removeClass('btn-outline-danger').addClass('btn-danger').text('Удалить из избранного');#}
{#                        } else if (response.action === 'removed') {#}
{#                            button.removeClass('btn-danger').addClass('btn-outline-danger').text('Добавить в избранное');#}
{#                        }#}
{#                    },#}
{#                    error: function (xhr, status, error) {#}
{#                        console.error("Ошибка:", error);#}
{#                    }#}
{#                });#}
{#            });#}
{#        });#}
{#    </script>#}
{##}
{#    <div class="container p-4 pt-3">#}
{#        <div class="row text-center justify-content-between">#}
{#            <h1 class="p-1">Список тестов категории</h1>#}
{#            {% include 'grid_tests_cards.html' with tests=catalog.tests_ids %}#}
{#        </div>#}
{#    </div>#}
{##}
{#    <div class="container p-4 pt-3">#}
{#        <div class="row text-center justify-content-between">#}
{#            <h1 class="p-1">Список cтатей категории</h1>#}
{#            {% include 'grid_articles_cards.html' with articles=catalog.articles_ids %}#}
{#        </div>#}
{#    </div>#}
{##}
{#    <div class="container p-4 pt-3">#}
{#        <div class="row text-center justify-content-between">#}
{#            <h1 class="p-1">Список атласов категории</h1>#}
{#            {% include 'grid_atlases_cards.html' with atlases=catalog.atlases_ids %}#}
{#        </div>#}
{#    </div>#}
{#{% endblock %}#}